{% extends 'dashboard.html' %}

{% block content %}
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
    .main--container {
        font-family: Arial, sans-serif;
        color: #333;
        background-color: #f4f4f4;
        padding: 20px;
    }

    .section--title {
        font-family: 'Roboto', sans-serif;
        font-size: 24px;
        font-weight: bold;
        width: fit-content;
        margin: auto auto 20px 1em;
        padding: 20px;
        background-color: #f4f4f4;
        border: 1px solid #ddd;
        border-radius: 3px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        animation: zoomIn 1s ease-out;
    }

    @media (max-width: 768px) {
        .section--title {
            font-size: 18px;
            padding: 15px;
            margin-bottom: 5px;
        }
    }

    @media (max-width: 480px) {
        .section--title {
            font-size: 14px;
            margin-bottom: 5px;
            padding: 10px;
        }
    }

    @keyframes zoomIn {
        from {
            opacity: 0;
            transform: scale(0.9);
        }

        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    .card {

        transition: transform 0.3s, opacity 0.3s;
        width: 30em;
        height: 25em;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        background: linear-gradient(60deg, #ffffff 0%, #eaf3f4 100%);
        background-size: 200% 200%;
        padding: 20px;
        color: #006064;
    }

    .card:hover {
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        transform: translateY(-5px);
    }


    @keyframes gradient {
        0% {
            background-position: 0% 50%;
        }

        50% {
            background-position: 100% 50%;
        }

        100% {
            background-position: 0% 50%;
        }
    }


    iframe {
        width: 100%;
        height: 376px;
        border: 1px solid #06869f;
        border-radius: 10px;
        overflow: hidden;
    }

    @media screen and (max-width: 600px) {
        iframe {
            width: 250px;
            overflow: auto;
        }

        .cards {
            flex-direction: column;
        }

        .card {
            margin-bottom: 20px;
        }
    }

    .chart {
        width: 100%;
        height: auto;
    }

    .cards {
        display: flex;
        overflow-x: hidden;
        gap: 20px;
    }

    .card {
        flex: 0 0 auto;
    }

    canvas {
        width: 100% !important;
        height: auto !important;
        animation: zoomIn 1s ease-out;
    }



    @keyframes zoomIn {
        from {
            opacity: 0;
            transform: scale(0.9);
        }

        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    .card {
        /* other styles... */
        opacity: 0;
    }

    .card:nth-child(odd) {
        animation: slideInFromLeft 0.7s forwards;
    }

    .card:nth-child(even) {
        animation: slideInFromRight 0.6s forwards;
    }



    @keyframes slideInFromLeft {
        from {
            opacity: 0;
            transform: translateX(-50px);
        }

        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    @keyframes slideInFromRight {
        from {
            opacity: 0;
            transform: translateX(50px);
        }

        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .chatbot-toggler {
        background-color: #033875 !important;
        border: none !important;
        color: white !important;
        padding: 15px !important;
        text-align: center !important;
        text-decoration: none !important;
        display: flex !important;
        /* Changed from inline-block to flex */
        justify-content: center !important;
        /* Added to center horizontally */
        align-items: center !important;
        /* Added to center vertically */
        font-size: 16px !important;
        margin: 4px 2px !important;
        cursor: pointer !important;
        border-radius: 50% !important;
    }

    .material-symbols-rounded,
    .material-symbols-outlined {
        color: white !important;
    }

    .chatbot {
        background-color: #efeff6 !important;
        /* Navy blue */
        color: white !important;
    }

    .chatbot header {
        background-color: #0b316b !important;
        /* Navy blue */
        color: white !important;
    }

    .chatbot .chat-input {
        background-color: #f3f3f6 !important;
        /* Navy blue */
        color: white !important;
    }

    .material-symbols-outlined,
    .material-symbols-rounded {
        color: white !important;
    }

    .close-btn {
        color: white !important;
    }

    #send-btn {
        background-color: white !important;
        color: #000080 !important;
        /* Navy blue */
    }
</style>
<div class="main--container">

    <h3 class="section--title">Welcome back, {{userName}}</h3>


    <div class="cards">
        <div class="card card-1">
            <iframe src="https://www.slideshare.net/slideshow/embed_code/key/KsIvFoKIqz2YqO?startSlide=1"
                frameborder="0" marginwidth="0" marginheight="0" scrolling="no" allowfullscreen></iframe>
        </div>

        <div class="card card-2">
            <iframe
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d13585.988214962876!2d74.86761208034926!3d31.64761835337063!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x39197d9917c20805%3A0xcc735ff7a3c09356!2sgluten%20free%20rasoi%20in%20Amritsar%20%2F%20gluten%20free%20products%2C%20snacks!5e0!3m2!1sen!2sin!4v1714464001868!5m2!1sen!2sin"
                allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            <div class="chart">
                <canvas id="orders"></canvas>
            </div>
        </div>
    </div>

    <div class="target--vs--sales">
        <canvas id="cdsAnalysis" width="800" height="800"> </canvas>
    </div>

    <button class="chatbot-toggler">
        <span class="material-symbols-rounded">mode_comment</span>
        <span class="material-symbols-outlined">close</span>
    </button>

    <div class="chatbot">
        <header>
            <h2>Mr. Adviser </h2>
            <span class="close-btn material-symbols-outlined">close</span>
        </header>
        <ul class="chatbox">
            <li class="chat incoming">
                <span class="material-symbols-outlined">smart_toy</span>
                <p>Hi there ðŸ‘‹<br />How can I help you today?</p>
            </li>
        </ul>
        <div class="chat-input">
            <textarea placeholder="Enter a message..." spellcheck="false" required></textarea>
            <span id="send-btn" class="material-symbols-rounded">send</span>
        </div>
    </div>
</div>

<div id="timeZone" style="display:none;">{{ dates }}</div>
<div id="results" style="display:none;">{{ cds_analysis_values }}</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>

<script>
    const ctx = document.getElementById('cdsAnalysis').getContext('2d');
    var dates = JSON.parse(document.getElementById('timeZone').textContent);
    var number_of_records = JSON.parse(document.getElementById('results').textContent);
    console.log(dates);
    console.log(number_of_records);
    const barChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: dates,
            datasets: [{
                label: 'CDS-Analysis',
                data: number_of_records,
                backgroundColor: 'rgba(75, 192, 192, 0.2)', // Change this to your preferred color
                borderColor: 'rgba(75, 192, 192, 1)', // Change this to your preferred color
                borderWidth: 2,
                pointBackgroundColor: 'rgba(75, 192, 192, 1)', // Change this to your preferred color
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgba(75, 192, 192, 1)',// Change this to your preferred color
                tension: 0.3
            }]
        },
        options: {
            responsive: true,
            title: {
                display: true,
                text: 'CDS Analysis Over Time',
                fontSize: 20
            },
            legend: {
                display: true,
                labels: {
                    fontSize: 15
                }
            },
            tooltips: {
                mode: 'index',
                intersect: false,
            },
            hover: {
                mode: 'nearest',
                intersect: true
            },
            scales: {
                xAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                        labelString: 'Date',
                        fontSize: 15
                    },
                    gridLines: {
                        display: true,
                        color: 'rgba(0, 0, 0, 0.1)'
                    }
                }],
                yAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                        labelString: 'Value',
                        fontSize: 15
                    },
                    gridLines: {
                        display: true,
                        color: 'rgba(0, 0, 0, 0.1)'
                    }
                }]
            }
        }
    });
</script>
{% endblock %}